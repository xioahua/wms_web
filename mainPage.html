<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>仓库管理系统</title>
    <link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./css/bootstrap-table.css">
    <link rel="stylesheet" type="text/css" href="./css/mainPage.css">
    <script type="text/javascript" src="./js/jquery-2.2.3.min.js"></script>
    <script type="text/javascript" src="./js/bootstrap.min.js"></script>
    <!-- toastr消息提示 -->
    <link rel="stylesheet" href="../css/toastr.min.css">
    <script src="../js/toastr.min.js"></script>
    <script type="text/javascript">		// js初始化
        toastr.options.positionClass = 'toast-top-center';
    </script>
</head>
<body style="padding-top: 55px;">
<div id="app">
    
    <!-- 导航栏 -->
    <div id="navBar">
        <!-- 此处加载顶部导航栏 -->
        <!-- 导航栏 -->
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="background-color: #ce000a;">
            <div class="container-fluid">
                <!-- 导航栏标题 -->
                <div id="logo" class="navbar-header">
                    <div>
                        <img src="./media/images/logo.png" style="width: 400px; height: 55px" alt="logo">
                    </div>
                    <span class="navbar-brand home" style="color:#fff;">智能仓库管理系统</span>
                </div>

                <!-- 导航栏下拉菜单；用户信息与注销登陆 -->
                <div>
                    <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" style="background-color: #ce000a;"> 
                                <span class="glyphicon glyphicon-user" style="color:#fff;"></span>
                                <span style="color:#fff; font-weight: bold;">欢迎&nbsp;用户名：{{userName}}</span>
                                <span class="caret" style="color:#fff;"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- <li>
                                    <a href="#" id="editInfo"><span class="glyphicon glyphicon-pencil"></span>修改个人信息</a>
                                </li> -->
                                <li>
                                    <a @click="signOut()"><span class="glyphicon glyphicon-off"></span>注销登录</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <!-- data-ride="carousel"设置为自动播放，data-interval="2500"可以调整轮播时间间隔 -->
    <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="5000" style="width: 100%; height: 100%;">
        <!-- 轮播（Carousel）指标 -->
        <ol class="carousel-indicators">
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
            <li data-target="#myCarousel" data-slide-to="1"></li>
            <li data-target="#myCarousel" data-slide-to="2"></li>
            <li data-target="#myCarousel" data-slide-to="3"></li>
            <li data-target="#myCarousel" data-slide-to="4"></li>
        </ol>   
        <!-- 轮播（Carousel）图片 -->
        <div class="carousel-inner">
            <div class="item active">
                <img src="./media/images/01.jpg" alt="First slide">
            </div>
            <div class="item">
                <img src="./media/images/02.jpg" alt="Second slide">
            </div>
            <div class="item">
                <img src="./media/images/03.jpg" alt="Third slide">
            </div>
            <div class="item">
                <img src="./media/images/04.jpg" alt="fourth slide">
            </div>
            <div class="item">
                <img src="./media/images/05.jpg" alt="fifth slide">
            </div>
        </div>
        <!-- 轮播（Carousel）导航（上一张、下一张） -->
        <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right"></span>
            <span class="sr-only">Next</span>
        </a>
    </div> 
    
    <div class="container-fluid" style="padding-left: 0px;margin-top: 20px;">
        <div class="row">
            <!-- 左侧导航栏 -->
            <div id="sideBar" class="col-md-2 col-sm-2">
                <!--  此处加载左侧导航栏 -->
                <!-- 左侧导航栏  -->
                <div class="panel-group" id="accordion">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a href="#collapse1" data-toggle="collapse" data-parent="#accordion"
                                class="parentMenuTitle collapseHead">库存管理</a>
                                <div class="pull-right">
                                    <span class="caret"></span>
                                </div>
                            </h4>
                        </div>
                        <div id="collapse1" class="panel-collapse collapse collapseBody in">   <!-- in默认是否展开 -->
                            <div class="panel-body">
                                <ul class="list-group">
                                    <!-- 系统管理员仓库管理-->
                                    <ul class="list-group">
                                        <li class="list-group-item">
                                            <a href="./html/stockMangement.html"  class="menu_item" target="contentPanel">库存管理</a>
                                        <li class="list-group-item">
                                            <a href="./html/stockRecordManagement.html"  class="menu_item" target="contentPanel">出入库记录</a>
                                        </li>
                                        <li class="list-group-item">
                                            <a href="./html/stockMingXi.html"  class="menu_item" target="contentPanel">出入库明细</a>
                                        </li>
                                    </ul>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a href="#collapse2" data-toggle="collapse" data-parent="#accordion"
                                    class="parentMenuTitle collapseHead">基础信息管理</a>
                                <div class="pull-right">
                                    <span class="caret"></span>
                                </div>
                            </h4>
                        </div>
                        <div id="collapse2" class="panel-collapse collapse collapseBody">
                            <div class="panel-body">
                                <ul class="list-group">
                                    <!-- <li class="list-group-item">
                                        <a href="./html/supplierManagement.html"  class="menu_item" target="contentPanel">供应商基础信息管理</a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="./html/customerManagement.html"  class="menu_item" target="contentPanel">客户基础信息管理</a>
                                    </li> -->
                                    <li class="list-group-item">
                                        <a href="./html/goodsBaseMangement.html"  class="menu_item" target="contentPanel">物资基础信息管理</a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="./html/repositoryBaseMangement.html"  class="menu_item" target="contentPanel">仓库基础信息管理</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- 采购管理 -->
                    <!-- <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a href="#collapse3" data-toggle="collapse" data-parent="#accordion"
                                    class="parentMenuTitle collapseHead">采购管理</a>
                                <div class="pull-right	">
                                    <span class="caret"></span>
                                </div>
                            </h4>
                        </div>
                        <div id="collapse3" class="panel-collapse collapse collapseBody">
                            <div class="panel-body">
                                <ul class="list-group">
                                    <li class="list-group-item">
                                        <a href="./html/repositoryAdminMangement.html"  class="menu_item" target="contentPanel">采购申请</a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="./html/repositoryAdminMangement.html"  class="menu_item" target="contentPanel">采购到货管理</a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="./html/repositoryAdminMangement.html"  class="menu_item" target="contentPanel">其他采购入库</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div> -->
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a href="#collapse4" data-toggle="collapse" data-parent="#accordion"
                                    class="parentMenuTitle collapseHead">人员信息管理</a>
                                <div class="pull-right">
                                    <span class="caret"></span>
                                </div>
                            </h4>
                        </div>
                        <div id="collapse4" class="panel-collapse collapse collapseBody">
                            <div class="panel-body">
                                <ul class="list-group">
                                    <li class="list-group-item">
                                        <a href="./html/repositoryAdminMangement.html"  class="menu_item" target="contentPanel">仓库管理员信息管理</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a href="#collapse5" data-toggle="collapse" data-parent="#accordion"
                                class="parentMenuTitle collapseHead">系统维护</a>
                                <div class="pull-right"><span class="caret"></span></div>
                            </h4>
                        </div>
                        <div id="collapse5" class="panel-collapse collapse collapseBody">
                            <div class="panel-body">
                                <ul class="list-group">
                                    <li class="list-group-item" data-url="./html/repositoryMangement.html">
                                        <!-- <a href="#" data-toggle="modal" data-target="#init_password_modify">修改密码</a> -->
                                        <a href="./html/updatePassWord.html"  class="menu_item" target="contentPanel">修改密码</a>
                                        </li>
                                    <li class="list-group-item">
                                        <a href="./html/userOperationRecorderManagement.html"  class="menu_item" target="contentPanel">操作日志</a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="./html/accessRecordManagement.html"  class="menu_item" target="contentPanel">登陆日志</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 面板区域 -->
            <div id="panel" name="panel" class="col-md-10 col-sm-10">
                <!--  此处异步加载各个面板 -->
                <iframe src="./html/index.html" id="myiframe" width="100%" :userId="userId" :value="token" οnlοad="changeFrameHeight()" frameborder="0" name="contentPanel" scrolling="auto"></iframe>
            </div>
        </div>
        <!-- 面板底脚 -->
        <div class="panel-footer row">
            <div class="col-sm-offset-3 col-sm-6">
                <p style="text-align: center;">大唐四川电力检修运营有限公司&emsp;版权所有&emsp;&emsp;Copyright © 2020</p>
                <p style="text-align: center;">川ICP备 17014456 号&emsp;&emsp;地址：成都市青羊区蜀金路1号金沙万瑞中心1幢306号&emsp;&emsp;电话：028-61678802</p>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="./js/vue.js"></script>
<script type="text/javascript" src="./js/axios.min.js"></script>
<script type="text/javascript" src="./js/jquery.params.js"></script>

<script>
    const app = new Vue({
        el:"#app",
        data:{
            userId:"",
            userName:"",
            token:"",
        },
        methods: {
            changeFrameHeight(){    //动态设置ifram高度
                let ifm= document.getElementById("myiframe"); 
                ifm.height=document.body.clientHeight;
                console.log(ifm.height)
            },
            getUserInfo(){      //需要引用jquery.params.js
                this.userId = $.query.get("userId");
                this.userName = $.query.get("userName");
                this.token = $.query.get("token");
            },
            signOut(){
                axios.get("http://localhost:8080/SMS/account/logout?userid="+this.userId+"&token="+this.token).then(res => {
                    console.log(res);
                    if(res.data.success == true || res.data.errorCode == "403"){
                        this.userId = "";
                        this.userName = "";
                        this.token = "";
                        window.location.href='./login.html';
                    }else{
                       alert(res.data.errorMsg)
                    }
                });
            },
        },
        created () {
            this.getUserInfo();
            if(this.token == ""){
                toastr.error("请先登陆！")
                window.location.href='./login.html';
            }
        }
    });
    window.οnresize=app.changeFrameHeight();
</script>
</body>
</html>